<html>
<head>
  <title>FileDB API</title>
</head>
<body>

<h1>FileDB API</h1>
<p>The FileDB API is only of interrest for developers who wants to use data stored by FileDB in other applications. To learn the details, run the web application and look at the network traffic.</p>
<p>Note that it is also possible to read the database file, but be aware that only one process should do this at the same time (including FileDB).</p>

<h2>Authentication</h2>
<pre>Request: POST /api/login?username=username&password=password
Response: 200 (OK), 401 (Unauthorized), cookie (session=...)

Request: POST /api/logout
Response: 200 (OK)
</pre>

<h2>Read Data: files</h2>
<pre>Request: GET /api/file/&lt;id&gt;
Request: GET /api/file_by_path/&lt;path&gt;
Response: 200 (OK), 404 (Not Found), 401 (Unathorized)
{
    "id": id,
    "path": path,
    "description": description,
    "personids": [1, 2, ...],
    "locationids": [1, 2, ...],
    "tagids": [1, 2, ...]
}

Request: GET /api/files/[?personids=personids][&locationids=locationids][&tagids=tagids]
Response: 200 (OK), 401 (Unathorized)
{
    "files" =
    [
        Same data here as for single file
    ]
}

Request: GET /api/filecontent/&lt;id&gt;
Response: 200 (OK), 404 (Not Found), data with content-type depending on file extension
</pre>

<h2>Read Data: persons</h2>
<pre>Request: GET /api/person/&lt;id&gt;
Response: 200 (OK), 404 (Not Found), 401 (Unathorized)
{
    "id": id,
    "name": name,
    "description": description,
    "dateofbirth": dateofbirth
}

Request: GET /api/persons
Response: 200 (OK), 401 (Unathorized)
{
    "persons" =
    [
        Same data here as for single person
    ]
}
</pre>

<h2>Read Data: locations</h2>
<pre>Request: GET /api/location/&lt;id&gt;
Response: 200 (OK), 404 (Not Found), 401 (Unathorized)
{
    "id": id,
    "name": name,
    "description": description
}

Request: GET /api/locations
Response: 200 (OK), 401 (Unathorized)
{
    "locations" =
    [
        Same data here as for single location
    ]
}
</pre>

<h2>Read Data: tags</h2>
<pre>Request: GET /tag/&lt;id&gt;
Response: 200 (OK), 404 (Not Found), 401 (Unathorized)
{
    "id": id,
    "name": name
}

Request: GET /api/tags
Response: 200 (OK), 401 (Unathorized)
{
    "tags" =
    [
        Same data here as for single tag
    ]
}
</pre>

<h2>Create Data</h2>
<pre>Request: POST /api/import
Request: POST /api/file/?path=path&description=description
Request: POST /api/directory/?path=path
Request: POST /api/person/?name=name
Request: POST /api/location/?name=name
Response: 200 (OK), 409 (Conflict), 401 (Unathorized)
</pre>

<h2>Modify Data</h2>
<pre>
Request: PUT /api/file/&lt;id&gt;
JSON data: ...
Response: 200 (OK), ...

Request: PUT /api/person/&lt;id&gt;
JSON data: ...
Response: 200 (OK), ...

Request: PUT /api/location/&lt;id&gt;
JSON data: ...
Response: 200 (OK), ...

Request: PUT /api/tag/&lt;id&gt;
JSON data: ...
Response: 200 (OK), ...
</pre>

<h2>Remove Data</h2>
<pre>
Request: DELETE /api/file/&lt;id&gt;
Request: DELETE /api/person/&lt;id&gt;
Request: DELETE /api/location/&lt;id&gt;
Request: DELETE /api/tag/&lt;id&gt;
Response: 200 (OK). 404 (Not Found), 401 (Unathorized)

Note that when removing a person, location or tag, this meta-data is removed from the files it was used in.
</pre>

<h2>Check File Consistency</h2>
<pre>Request: GET /api/fileconsistency
Response: 200 (OK), 401 (Unathorized)
{
    "missingfiles" = [fileid, fileid, ...]
}
</pre>

</body>
</html>
